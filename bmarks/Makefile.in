iRCCEINCLUDE := ../include

include $(SYMBOLSPATH)

CFLAGS := $(CFLAGS) -I$(iRCCEINCLUDE)
CFLAGSP := $(CFLAGS) -I$(iRCCEINCLUDE) -pthread
TMH := $(iRCCEINCLUDE)/../src/pubSubTM.c $(iRCCEINCLUDE)/../src/rwhash.c $(iRCCEINCLUDE)/../src/log.c $(iRCCEINCLUDE)/pubSubTM.h \
	$(iRCCEINCLUDE)/common.h $(iRCCEINCLUDE)/tm.h $(iRCCEINCLUDE)/stm.h \
	$(iRCCEINCLUDE)/hashtable.h $(iRCCEINCLUDE)/rwhash.h $(iRCCEINCLUDE)/log.h

BANKOBJS  := bank.o   $(ARCHIVE)
MTESTOBJS  := mtest.o   $(ARCHIVE)

.PHONY: all default clean bank

default:
	@echo "Usage: make bank"
	@echo "       make all "

all: bank

bank: $(BANKOBJS)
	$(CCOMPILE) -o bank $(BANKOBJS) $(CFLAGS)

bank.o: bank.c $(RCCEINCLUDE)/RCCE.h $(iRCCEINCLUDE)/iRCCE.h $(TMH)
	$(CCOMPILE) -c $(CFLAGS) bank.c

mtest: $(MTESTOBJS)
	$(CCOMPILE) -o mtest $(MTESTOBJS) $(CFLAGS)

mtest.o: mtest.c $(RCCEINCLUDE)/RCCE.h $(iRCCEINCLUDE)/iRCCE.h $(TMH)
	$(CCOMPILE) -c $(CFLAGS) mtest.c


clean:
	@ rm -f *.o bank



